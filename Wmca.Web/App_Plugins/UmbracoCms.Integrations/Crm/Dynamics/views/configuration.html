<div ng-controller="Umbraco.Cms.Integrations.Crm.Dynamics.ConfigurationController as vm">

    <umb-box-content style="height: 50px; position: relative;" ng-if="!vm.oauthInitialized">
        <umb-load-indicator />
    </umb-box-content>

    <div ng-if="vm.oauthInitialized">
        <p ng-if="vm.oauthConfig && vm.oauthConfig.isConnected"><b>Connected:</b> {{ vm.oauthConfig.fullName }} </p>
        <p ng-if="!vm.oauthConfig || !vm.oauthConfig.isConnected"><b>Disconnected</b></p>
        <div>
            <umb-button action="vm.onConnectClick()"
                        type="button"
                        button-style="primary"
                        state="init"
                        label="Connect"
                        disabled="vm.oauthConfig.isConnected">
            </umb-button>
            <umb-button action="vm.onRevokeToken()"
                        type="button"
                        button-style="danger"
                        state="init"
                        label="Revoke"
                        disabled="!vm.oauthConfig.isConnected">
            </umb-button>
        </div>
    </div>
    <div id="authCode" class="mt3">
        <input id="inAuthCode" type="text" ng-model="vm.authCode" placeholder="Authorization code" no-dirty-check />
        <umb-button action="vm.onAuthorize()"
                    type="button"
                    button-style="primary"
                    state="init"
                    label="Authorize">
        </umb-button>
    </div>
</div>